/**
 * Copyright (c) 2026 Realtek Semiconductor Corp.
 * SPDX-License-Identifier: Apache-2.0
 */

/**
 * @file effect_tunnel.h
 * @brief Tunnel Particle Effect - Warp Speed / Hyperspace Effect
 *
 * Tunnel effect characteristics:
 * - Ring emission from center
 * - Linear trajectory (fast outward movement)
 * - Solid white color
 * - Continuous emission
 * - Particles move in straight lines from center to edges
 * - Creates a "warp tunnel" or "hyperspace" visual effect
 *
 * This example demonstrates binary format loading (load_mem).
 * The binary configuration data is embedded as a C array.
 */

#ifndef EFFECT_TUNNEL_H
#define EFFECT_TUNNEL_H

#include "particle_effect.h"
#include "gui_particle_widget.h"

#ifdef __cplusplus
extern "C" {
#endif

/**
 * @brief Pre-generated binary configuration data for tunnel effect
 *
 * This data can be loaded directly using particle_effect_config_load_mem().
 * Uses the platform-independent binary format (320 bytes).
 *
 * Generated from effect_tunnel_config() with the following parameters:
 * - Shape: RING (center 240,240, inner_r=3, outer_r=10)
 * - Trajectory: LINEAR (no gravity, no damping)
 * - Emission: 360deg, speed 300-500 px/s, rate 40/s
 * - Lifecycle: 500-800ms, loop enabled
 * - Color: SOLID white (0xFFFFFFFF)
 * - Opacity: 255->0, LINEAR easing
 * - Scale: 0.5->2.5
 * - Boundary: KILL at screen edges (480x480)
 * - Render: ADDITIVE blend, base_size=3
 */
static const uint8_t tunnel_effect_binary_data[320] =
{
    /* Header (12 bytes): magic="PART", version=1, size=320, flags=0 */
    0x54, 0x52, 0x41, 0x50, 0x01, 0x00, 0x40, 0x01,
    0x00, 0x00, 0x00, 0x00,

    /* Shape (32 bytes): type=RING(4), cx=240, cy=240, inner_r=3, outer_r=10, reserved[8] */
    0x04, 0x00, 0x00, 0x00, 0x00, 0x00, 0x70, 0x43,
    0x00, 0x00, 0x70, 0x43, 0x00, 0x00, 0x40, 0x40,
    0x00, 0x00, 0x20, 0x41, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,

    /* Trajectory (40 bytes): type=LINEAR(0), gravity=0, damping=0, wind=0, orbit=0, reserved[8] */
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,

    /* Emission (32 bytes): angle_min=0, angle_max=2PI, speed 300-500, rate=40, burst_count=10 */
    0xDA, 0x0F, 0xC9, 0x40, 0x00, 0x00, 0x96, 0x43,
    0x00, 0x00, 0xFA, 0x43, 0x00, 0x00, 0x20, 0x42,
    0x0A, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0xF4, 0x01, 0x20, 0x03,

    /* Lifecycle (16 bytes): life_min=500, life_max=800, duration=0, auto_cleanup=0, loop=1 */
    0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,

    /* Color (48 bytes): mode=SOLID(0), color_start=white, color_end=white, palette[8], palette_size=0 */
    0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,

    /* Opacity (8 bytes): start=255, end=0, easing=LINEAR, reserved[5] */
    0xFF, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,

    /* Scale (20 bytes): start=0.5, end=2.5, min=0.8, max=1.2, reserved[4] */
    0x00, 0x00, 0x00, 0x3F, 0x00, 0x00, 0x20, 0x40,
    0xCD, 0xCC, 0x4C, 0x3F, 0x9A, 0x99, 0x99, 0x3F,
    0x00, 0x00, 0x00, 0x00,

    /* Rotation (20 bytes): angle_min=0, angle_max=0, speed_min=0, speed_max=0, align_velocity=1 */
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x01, 0x00, 0x00, 0x00,

    /* Boundary (24 bytes): behavior=KILL(1), left=0, top=0, right=480, bottom=480, damping=0.8 */
    0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xF0, 0x43,
    0x00, 0x00, 0xF0, 0x43, 0xCD, 0xCC, 0x4C, 0x3F,

    /* Behavior (20 bytes): mode=NONE(0), pulse_freq=1.0, pulse_amp=0.5, breathe_freq=1.0, reserved[4] */
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80, 0x3F,
    0x00, 0x00, 0x00, 0x3F, 0x00, 0x00, 0x80, 0x3F,
    0x00, 0x00, 0x00, 0x00,

    /* Render (12 bytes): blend=ADDITIVE(1), base_size=3.0, reserved */
    0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x40, 0x40,
    0x00, 0x00, 0x00, 0x00,

    /* Reserved (36 bytes) */
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
};

#define TUNNEL_EFFECT_BINARY_SIZE sizeof(tunnel_effect_binary_data)

/**
 * @brief Create tunnel warp speed particle effect
 *
 * Creates a "hyperspace" effect with particles shooting outward
 * from center. Tries binary config first, falls back to direct config.
 *
 * @param parent Parent widget to attach to
 * @param name Widget name
 * @param x X coordinate relative to parent
 * @param y Y coordinate relative to parent
 * @param w Widget width
 * @param h Widget height
 * @return Created widget pointer, NULL on failure
 */
gui_particle_widget_t *effect_tunnel_create(gui_obj_t *parent, const char *name,
                                            int16_t x, int16_t y, int16_t w, int16_t h);

/**
 * @brief Get pre-saved binary configuration data
 * @param size Output: size of binary data
 * @return Pointer to binary configuration data
 */
const void *effect_tunnel_get_binary_config(size_t *size);

#ifdef __cplusplus
}
#endif

#endif /* EFFECT_TUNNEL_H */
