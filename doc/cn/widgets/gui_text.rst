.. _文本 (Text):

===========
文本 (Text)
===========

文本控件是用于显示文本的基本控件，可用于将多样化的文本渲染到屏幕上，支持矢量字体和点阵字体两种渲染方式。

特性
-----

文本控件能支持下面的特性。

+ 支持 UTF-8 / UTF16 / UTF-32
+ 支持多语言
+ 支持文本排版
+ 自动换行和文本滚动
+ 抗锯齿
+ 支持多种字体
+ 支持多种字号
+ 支持 32 位真彩色
+ 支持 EMOJI 表情
+ 支持自定义动画效果
+ 支持点阵字体和矢量字体
+ 支持自行开发的字体文件

.. note::
    多语言支持覆盖标准拉丁字符语言（如英文、法语），亚洲主要语言（如中文、日文、韩文），以及需要复杂字符渲染的语言（如阿拉伯语、波斯语、泰语等，包含变形、组合或者修饰字符文本）。

.. note::
    只有部分芯片支持矢量字体。

用法
-----
调用对应的函数加载字体文件并显示文本。

字体文件
~~~~~~~~~~~~~~
为了绘制文本，包含字体信息的字体文件需要加载到系统中。

字体文件可以通过 Realtek 字体转换器生成，有点阵字体和矢量字体两种类型。字体文件可以提前初始化，由控件字号自动检索字体进行渲染，也可以单独为文本控件设置独特的字体。

初始化自定义bin字体文件，需要根据系统的文件读取方式选择调用  :cpp:any:`gui_font_mem_init_mem` 或者 :cpp:any:`gui_font_mem_init_ftl` 。

创建文本控件
~~~~~~~~~~~~
开发者可以调用 :cpp:any:`gui_text_create` 来创建文本控件。创建后，控件的坐标和文本框的大小已经确定。这些属性也可以随时修改。

.. note::
    文本控件的大小应大于要显示的字符串，超出范围的文本将被隐藏。

设置文本属性
~~~~~~~~~~~~

设置文本
^^^^^^^^
开发者可以调用 :cpp:any:`gui_text_set` 来设置文本控件文本、文本类型、颜色、长度和文本字体大小。

.. note::
    文本长度必须小于等于设置的字符长度。对于点阵字体，文本字体大小必须与加载的字体文件的大小相同；对于矢量字体，可以动态设置字体大小。

字体类型
^^^^^^^^
文本控件支持字体类型设置。开发者可以调用 :cpp:any:`gui_text_type_set` 来设置字体源。可以设置字体文件的地址，并指定字体源模式。

文本内容
^^^^^^^^
开发者可以调用 :cpp:any:`gui_text_content_set` 来设置文本控件需要显示的内容。

文本编码
^^^^^^^^
文本控件同时支持 UTF-8 编码、UTF-16 编码和 UTF-32 编码输入格式，开发者可以使用 :cpp:any:`gui_text_encoding_set` 更改编码方式。

文本转换为图片
^^^^^^^^^^^^^^
使用 :cpp:any:`gui_text_convert_to_img` 可以将文本控件中的文本将被转换为图像，存储在内存中，并使用该图像进行呈现。它还支持图像转换，如缩放和旋转。这只适用于点阵字体。

.. note::
    因为需要文本控件的内容和字体大小信息，所以应该在设置文本之后调用它。如果修改了文本的内容、字体大小、位置和其他属性，则需要重用此接口进行转换。

文本颜色
^^^^^^^^
开发者可以使用函数 :cpp:any:`gui_text_color_set` 设置文本的颜色。

字体大小
^^^^^^^^
开发者可以使用函数 :cpp:any:`gui_text_size_set` 设置字体的大小。

自动换行
^^^^^^^^
开发者可以使用函数 :cpp:any:`gui_text_wordwrap_set` 启用或禁用英文单词的自动换行功能。

字符间距和行间距
^^^^^^^^^^^^^^^^
开发者可以使用函数 :cpp:any:`gui_text_extra_letter_spacing_set` 设置额外的字符间距，使用 :cpp:any:`gui_text_extra_line_spacing_set` 设置额外的行间距。

矩阵变换
^^^^^^^^
开发者可以使用函数 :cpp:any:`gui_text_set_matrix` 为文本控件设置变换矩阵，实现旋转、缩放等效果。使用 :cpp:any:`gui_text_use_matrix_by_img` 可以启用基于图像的矩阵渲染，适用于复杂变换。

最小缩放比例
^^^^^^^^^^^^
开发者可以使用函数 :cpp:any:`gui_text_set_min_scale` 设置文本的最小缩放比例。

字体渲染模式
^^^^^^^^^^^^
对于 TTF 矢量字体，开发者可以使用函数 :cpp:any:`gui_text_rendermode_set` 设置光栅化渲染模式（1/2/4/8）。

EMOJI 表情
^^^^^^^^^^
开发者可以使用函数 :cpp:any:`gui_text_emoji_set` 设置 EMOJI 表情图像文件的路径和大小。需要配合文件系统使用。

文本模式
^^^^^^^^
文本控件当前支持31种排版模式，包括以下几类：

 + 单行排版模式（3种）：适用于仅显示一行文本的场景，如单行居中、左对齐、右对齐等。
 + 多行排版模式（3种）：用于显示多行文本，支持多行居中、多行左对齐、多行右对齐等多种排列方式。
 + 单行中部排版模式（3种）：单行文本在垂直方向居中显示，支持左对齐、居中、右对齐。
 + 多行中部排版模式（3种）：多行文本在垂直方向居中显示，支持左对齐、居中、右对齐。
 + 滚动排版模式（6种）：适合文本超出显示区域时，以滚动方式显示内容，包括水平滚动（顶部和中部）和垂直滚动。
 + 竖向排版模式（6种）：支持文本从上到下的竖排显示方式，也可作为旋转文本的通用排版方式，包括顶端对齐、中部对齐、底端对齐等。
 + 从右至左（ RTL ）排版模式（6种）：针对如阿拉伯语、希伯来语等从右至左书写的语言，支持相应的排版模式。

每种排版模式都可根据实际应用场景选择，满足多样化的文本显示需求。通过 :cpp:any:`gui_text_mode_set` 来设置文本排版模式。

排版模式如下：

.. table:: 文本模式
   :widths: 25 15 15 25 20
   :align: center

   +-------------------------+----------+----------------+------------------------+------------------+
   | 类型                    | 行类型   | X 方向         | Y 方向                 | 控件             |
   +=========================+==========+================+========================+==================+
   | `LEFT`                  | 单行     | 左对齐         | 顶部                   | 文本控件(默认)   |
   +-------------------------+----------+----------------+------------------------+------------------+
   | `CENTER`                | 单行     | 居中           | 顶部                   | 文本控件         |
   +-------------------------+----------+----------------+------------------------+------------------+
   | `RIGHT`                 | 单行     | 右对齐         | 顶部                   | 文本控件         |
   +-------------------------+----------+----------------+------------------------+------------------+
   | `MULTI_LEFT`            | 多行     | 左对齐         | 顶部                   | 文本控件         |
   +-------------------------+----------+----------------+------------------------+------------------+
   | `MULTI_CENTER`          | 多行     | 居中           | 顶部                   | 文本控件         |
   +-------------------------+----------+----------------+------------------------+------------------+
   | `MULTI_RIGHT`           | 多行     | 右对齐         | 顶部                   | 文本控件         |
   +-------------------------+----------+----------------+------------------------+------------------+
   | `MID_LEFT`              | 单行     | 左对齐         | 中部                   | 文本控件         |
   +-------------------------+----------+----------------+------------------------+------------------+
   | `MID_CENTER`            | 单行     | 居中           | 中部                   | 文本控件         |
   +-------------------------+----------+----------------+------------------------+------------------+
   | `MID_RIGHT`             | 单行     | 右对齐         | 中部                   | 文本控件         |
   +-------------------------+----------+----------------+------------------------+------------------+
   | `MULTI_MID_LEFT`        | 多行     | 左对齐         | 中部                   | 文本控件         |
   +-------------------------+----------+----------------+------------------------+------------------+
   | `MULTI_MID_CENTER`      | 多行     | 居中           | 中部                   | 文本控件         |
   +-------------------------+----------+----------------+------------------------+------------------+
   | `MULTI_MID_RIGHT`       | 多行     | 右对齐         | 中部                   | 文本控件         |
   +-------------------------+----------+----------------+------------------------+------------------+
   | `SCROLL_X`              | 单行     | 由右向左滚动   | 顶部                   | 滚动文本控件     |
   +-------------------------+----------+----------------+------------------------+------------------+
   | `SCROLL_X_REVERSE`      | 单行     | 由左向右滚动   | 顶部                   | 滚动文本控件     |
   +-------------------------+----------+----------------+------------------------+------------------+
   | `SCROLL_X_MID`          | 单行     | 由右向左滚动   | 中部                   | 滚动文本控件     |
   +-------------------------+----------+----------------+------------------------+------------------+
   | `SCROLL_X_MID_REVERSE`  | 单行     | 由左向右滚动   | 中部                   | 滚动文本控件     |
   +-------------------------+----------+----------------+------------------------+------------------+
   | `SCROLL_Y`              | 多行     | 左对齐         | 由下向上滚动           | 滚动文本控件     |
   +-------------------------+----------+----------------+------------------------+------------------+
   | `SCROLL_Y_REVERSE`      | 多行     | 右对齐         | 由上向下滚动           | 滚动文本控件     |
   +-------------------------+----------+----------------+------------------------+------------------+
   | `VERTICAL_LEFT_TOP`     | 多行     | 左对齐         | 由上向下，顶端对齐     | 文本控件         |
   +-------------------------+----------+----------------+------------------------+------------------+
   | `VERTICAL_LEFT_MID`     | 多行     | 左对齐         | 由上向下，中部对齐     | 文本控件         |
   +-------------------------+----------+----------------+------------------------+------------------+
   | `VERTICAL_LEFT_BOT`     | 多行     | 左对齐         | 由上向下，底端对齐     | 文本控件         |
   +-------------------------+----------+----------------+------------------------+------------------+
   | `VERTICAL_RIGHT_TOP`    | 多行     | 右对齐         | 由下向上，顶端对齐     | 文本控件         |
   +-------------------------+----------+----------------+------------------------+------------------+
   | `VERTICAL_RIGHT_MID`    | 多行     | 右对齐         | 由下向上，中部对齐     | 文本控件         |
   +-------------------------+----------+----------------+------------------------+------------------+
   | `VERTICAL_RIGHT_BOT`    | 多行     | 右对齐         | 由下向上，底端对齐     | 文本控件         |
   +-------------------------+----------+----------------+------------------------+------------------+
   | `RTL_RIGHT`             | 多行     | 右对齐         | 顶部                   | 文本控件         |
   +-------------------------+----------+----------------+------------------------+------------------+
   | `RTL_CENTER`            | 多行     | 居中           | 顶部                   | 文本控件         |
   +-------------------------+----------+----------------+------------------------+------------------+
   | `RTL_LEFT`              | 多行     | 左对齐         | 顶部                   | 文本控件         |
   +-------------------------+----------+----------------+------------------------+------------------+
   | `RTL_MULTI_RIGHT`       | 多行     | 右对齐         | 顶部                   | 文本控件         |
   +-------------------------+----------+----------------+------------------------+------------------+
   | `RTL_MULTI_CENTER`      | 多行     | 居中           | 顶部                   | 文本控件         |
   +-------------------------+----------+----------------+------------------------+------------------+
   | `RTL_MULTI_LEFT`        | 多行     | 左对齐         | 顶部                   | 文本控件         |
   +-------------------------+----------+----------------+------------------------+------------------+

.. literalinclude:: ../../../realgui/widget/gui_text/gui_text.h
   :language: c
   :start-after: /* TEXT_MODE start */
   :end-before: /* TEXT_MODE end */


文本移动
^^^^^^^^
开发者可以调用函数 :cpp:any:`gui_text_move` 将文本控件移动到指定位置。


示例
------

简单文本控件
~~~~~~~~~~~~~
.. literalinclude:: ../../../example/widget/text/example_gui_text.c
   :language: c
   :start-after: /* gui text widget example start*/
   :end-before: /* gui text widget example end*/


API
-----

.. doxygenfile:: gui_text.h

